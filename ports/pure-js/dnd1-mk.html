<html>
<head>
<script>
function ddinit()
{
	document.write('<textarea id="console" cols="80" rows="12">');
	document.write('</textarea>');
	document.write('<input id="command" name="command" type="text" size="80" onkeydown="Javascript: if (event.keyCode==13) ddcliinterpreter(this)">');
	document.write("\n");
	consoleobj = document.getElementById('console');
	commandobj = document.getElementById('command');
	passthru = '';
	ddinitglobalmemory();
	ddintro();
}

function ddintro()
{
	ddwr("     RICHARD GARRIOTT DND1");
	ddwr("");
	ddwr("DO YOU NEED INSTRUCTION (Y)ES OR (N)O");
	ddwrgetinput('ddinstruction');
}

function ddinstruction(cliinput)
{
	if((cliinput == 'Y') || (cliinput == 'YES'))
	{
		//01730
		ddwr("WHO SAID YOU COULD PLAY");
		return;
	}
	else if((cliinput == 'N') || (cliinput == 'NO'))
	{
		//00380
		ddwr("(O)LD OR (N)EW GAME");
		ddwrgetinput('ddoldnewgame');
	}
	else
	{
		ddwrgetinput('ddinstruction');
	}
}

function ddoldnewgame(cliinput)
{
	if((cliinput == 'O') || (cliinput == 'OLD'))
	{
		//TODO 01770
		ddwr("NOT IMPLEMENTED YET");
		ddwr("(O)LD OR (N)EW GAME");
		ddwrgetinput('ddoldnewgame');
		return;
	}
	else if((cliinput == 'N') || (cliinput == 'NEW'))
	{
		ddwr("DUNGEON #");
		ddwrgetinput('dddungeonnumber');
		return;
	}
	else
	{
		ddwrgetinput('ddoldnewgame');
	}
}

function dddungeonnumber(cliinput)
{
	ddglobal['D'] = 99;
	if(cliinput == '0')
	{
		ddglobal['D'] = 0;
	}
	else if(cliinput == '1')
	{
		ddglobal['D'] = 1;
	}
	else
	{
		ddwrgetinput('dddungeonnumber');
	}
	if((ddglobal['D'] >= 0) && (ddglobal['D'] <= 6))
	{
		ddwr("CONTINUES RESET 1=YES,2=NO ");
		ddwrgetinput('ddcontinuereset');
	}
}

/*
line 00422
*/
function ddcontinuereset(cliinput)
{
	ddglobal['J6'] = 99;
	if(cliinput == '1')
	{
		ddglobal['J6'] = 1;
	}
	else if(cliinput == '2')
	{
		ddglobal['J6'] = 2;
	}
	else
	{
		ddwrgetinput('ddcontinuereset');
	}
	if((ddglobal['J6'] == 1) || (ddglobal['J6'] == 2))
	{
		ddwr("PLAYERS NME ");
		ddwrgetinput('ddplayersname');
	}
}

/*
line 00450
*/
function ddplayersname(cliinput)
{
	ddglobal['NS'] = 99;
	if(cliinput == 'SHAVS')
	{
		ddgeneratestats();
		ddclassification_pre();
	}
	else
	{
		//01730
		ddwr("WHO SAID YOU COULD PLAY");
		return;
	}
}

/*
line 00470
*/
function ddgeneratestats()
{
	ddglobal['C'] = Array();
	//set hit points to 0
	ddglobal['C'][0] = 0;
	for(var M = 1; M <= 7; M++)
	{
		ddglobal['C'][M] = 0;
		for(var N = 1; N <= 3; N++)
		{
			var R = Math.floor(Math.random() * 6) + 1;
			ddglobal['C'][M] = ddglobal['C'][M] + R;
		}
		if(M != 7)
		{
			ddwr(ddglobal['CS'][M]+"="+ddglobal['C'][M]);
		}
		else
		{
			ddglobal['C'][M] = ddglobal['C'][M] * 15;
		}
	}
}

/*
line 00580
*/
function ddclassification_pre()
{
	ddwr("");
	ddwr("CLASSIFICATION");
	ddwr("WHICH DO YOU WANT TO BE");
	ddwr("(F)IGHTER ,(C)LERIC ,OR (W)IZARD");
	ddwrgetinput('ddclassification');
}

/*
line 00620
*/
function ddclassification(cliinput)
{
	ddglobal['CS'][0] = '';
	if((cliinput == 'F') || (cliinput == 'FIGHTER'))
	{
		ddglobal['CS'][0] = 'FIGHTER';
		ddglobal['C'][0] = Math.floor(Math.random() * 8) + 1;
		ddbuyingweapons_pre();
	}
	else if((cliinput == 'C') || (cliinput == 'CLERIC'))
	{
		ddglobal['CS'][0] = 'CLERIC';
		ddglobal['C'][0] = Math.floor(Math.random() * 8) + 1;
		ddbuyingweapons_pre();
	}
	else if((cliinput == 'W') || (cliinput == 'WIZARD'))
	{
		ddglobal['CS'][0] = 'WIZARD';
		ddglobal['C'][0] = Math.floor(Math.random() * 8) + 1;
		ddbuyingweapons_pre();
	}
	else if(cliinput == 'NONE')
	{
		ddglobal['CS'][0] = 'NONE';
		//NONE is like reroll
		//line 00625
		ddgeneratestats();
		ddclassification_pre();
	}
	else
	{
		ddwrgetinput('ddclassification');
	}
}

/*
line 00670
*/
function ddbuyingweapons_pre()
{
	ddwr("BUYING WEAPONS");
	ddwr("NUMBER","ITEM","PRICE");
	//TODO fast or norm routine
	ddwr("(0)-STOP");
	for(var M = 1; M <= 16; M++)
	{
		ddwr("("+M+")- "+ddglobal['IS'][M]+" - "+ddglobal['P'][M]);
	}
	ddwrgetinput('ddbuyingweapons');
}

/*
line 00830
*/
function ddbuyingweapons(cliinput)
{
	//ddglobal['Y'] = cliinput;
	if(cliinput == 'L')
	{
		ddbuyingweapons_pre();
	}
	else
	{
		//this varies from the old code
		if(isNaN(cliinput))
		{
			ddwr("ENTER NUMBER 0 - 16 or L");
			ddwrgetinput('ddbuyingweapons');
		}
		else
		{
			cliinput = parseInt(cliinput);
			ddglobal['Y'] = cliinput;
			if((cliinput < 1) || (cliinput > 16))
			{
				ddgoldcount_pre();
			}
			else
			{
				ddpurchasecheck();
			}
		}
	}
}

/*
line 00890
line 00970
*/
function ddpurchasecheck()
{
	if( (ddglobal['C'][7] - ddglobal['P'][ddglobal['Y']]) < 0 )
	{
		ddwr("COSTS TOO MUCH");
		ddwr("TRY AGAIN ");
		ddwrgetinput('ddbuyingweapons');
	}
	if( ddglobal['CS'][0] = 'CLERIC' )
	{
		if( (ddglobal['Y'] == 4) || (ddglobal['Y'] == 8) || (ddglobal['Y'] == 9) || (ddglobal['Y'] > 10) )
		{
			ddpurchaseit();
		}
		else
		{
			ddwr("YOUR A CLERIC YOU CANT USE THAT ");
			ddwr("ENTER NUMBER 0 - 16 or L");
			ddwrgetinput('ddbuyingweapons');
		}
	}
	else if( ddglobal['CS'][0] = 'WIZARD' )
	{
		if( (ddglobal['Y'] == 3) || (ddglobal['Y'] == 8) || (ddglobal['Y'] > 10) )
		{
			ddpurchaseit();
		}
		else
		{
			ddwr("YOUR A WIZARD YOU CANT USE THAT ");
			ddwr("ENTER NUMBER 0 - 16 or L");
			ddwrgetinput('ddbuyingweapons');
		}
	}
		//keeps track of how many items have been bought
		ddglobal['X'] = ddglobal['X'] + 1;
		ddglobal['C'][7] = ddglobal['C'][7] - ddglobal['P'][ddglobal['Y']];

}




/*
utility functions
*/

function ddwr(txtscalar)
{
	consoleobj.innerHTML = consoleobj.innerHTML + txtscalar + "\n";
	consoleobj.scrollTop = consoleobj.scrollHeight;
}

function ddwrgetinput(passfunctionname)
{
	passthru = passfunctionname;
	if(commandobj.value)
	{
		commandobj.value = '';
	}
	commandobj.focus();
}

function ddcliinterpreter(inputobj)
{
	var cliinput = '';
	if(inputobj.value)
	{
		cliinput = inputobj.value;
		cliinput = cliinput.toUpperCase();
	}
	//DANGER WIL ROBINSON
	var execcom = passthru+'("'+cliinput+'")';
	eval(execcom);
	//LATER remove eval and write out by hand for security
	if(passthru == 'ddinstruction')
	{
		//ddinstruction(cliinput);
	}
	else if(passthru == '')
	{

	}
}

/*
global memory
I wanted to keep the original 1 to n loops instead of adjusting them to 0.
But javascript starts counting at 0 so keep that in mind.
*/
function ddinitglobalmemory()
{
	ddglobal = Array();
	ddglobal['CS'] = Array('skip0');
	ddglobal['CS'][1] = "STR";
	ddglobal['CS'][2] = "DEX";
	ddglobal['CS'][3] = "CON";
	ddglobal['CS'][4] = "CHAR";
	ddglobal['CS'][5] = "WIS";
	ddglobal['CS'][6] = "INT";
	ddglobal['CS'][7] = "GOLD";

	ddglobal['IS'] = Array('skip0');
	ddglobal['P'] = Array('skip0');

	var itemlist = Array
	(
		"SWORD",10,"2-H-SWORD",15,"DAGGER",3,"MACE",5,
		"SPEAR",2,"BOW",25,"ARROWS",2,"LEATHER MAIL",15,
		"CHAIN MAIL",30,"TLTE MAIL",50,"ROPE",1,"SPIKES",1,
		"FLASK OF OIL",2,"SILVER CROSS",25,"SPARE FOOD",5,
		"MJOLNIR",1
	);

	for(var M = 1; M <= 16; M++)
	{
		var j = (M * 2) - 2;
		var k = j + 1;

		ddglobal['IS'][M] = itemlist[j];
		ddglobal['P'][M] = itemlist[k];
	}

	ddglobal['X'] = 0;
}
</script>
</head>
<body>

<script>

ddinit();
</script>

</body>